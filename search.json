[
  {
    "objectID": "blog/replica-trick-tutorial.html",
    "href": "blog/replica-trick-tutorial.html",
    "title": "Tutorial on Replica Trick",
    "section": "",
    "text": "In physics, one is often concered with finding the quenched free energy \\[\\begin{align}\n- \\beta F = \\mathbb E[\\log Z]\n\\end{align}\\] In bayesian machine learning / probablistic graphical models, one might be concered with computing the evidence \\(p(\\mathcal D)\\). However in practice, it’s extrememly difficult to calculate this quantity. Here I’ll present Georgio Parisi’s method (for which he won the Nobel Prize) to compute such quantities: the replica trick.\nThe trick can be summarized as applying the formula \\[\\begin{align}\n\\mathbb E[\\log Z] = \\lim_{n \\to 0} \\frac{1}{n} \\log \\mathbb E[Z^n]\n\\end{align}\\] where one interprets \\(Z^n\\) to be \\(n\\) statistically independent replicas of the variables. From there, you non-rigoroulsy analytically continue \\(n\\) down to zero."
  },
  {
    "objectID": "blog/replica-trick-tutorial.html#replica-symmetry-solution",
    "href": "blog/replica-trick-tutorial.html#replica-symmetry-solution",
    "title": "Tutorial on Replica Trick",
    "section": "Replica Symmetry Solution",
    "text": "Replica Symmetry Solution\nDefinition (Replica Symmetry (Breaking)): At the beginning of the calculation, we assumed replicas are statistically independent. So that means we can permute our replicas at no cost. Stated formally, let \\(\\pi\\) is some permutation operator. When the dominant saddle point exhibits \\[\\begin{align}\n  g(Q_{\\pi(a), \\pi(b)}) = g(Q)\n\\end{align}\\] the system has replica symmetry.\nIn the case where we have replica symmetry, this fixes \\(Q\\) as it’s entries should be invariant under permutation. \\(Q_{aa} = \\alpha\\), and \\(Q_{ab} = \\beta\\) for all combinations \\(a\\neq b\\). \\[\\begin{align}\n  Q = \\begin{pmatrix}\n    \\alpha & \\beta & \\beta & \\\\\n    \\beta & \\alpha & \\beta & ...\\\\\n    \\beta & \\beta & \\alpha & \\\\\n      & \\vdots &  & \\ddots\n  \\end{pmatrix} = (\\alpha - \\beta) \\mathbb I + \\beta  ~ xx^T, && \\text{where } x = (1,1,...)\n\\end{align}\\] Hence it should look like an identity plus a rank 1 correction.\nHowever, by some law I saw in Interstelar (2014), if something can go wrong, it will go wrong. And in physics, it goes extra crazy. Replica symmetry can be spontaneously broken in the \\(N \\to \\infty\\) limit (analogous to the \\(\\mathbb Z_2\\) symmetry breaking exhibits by the Curie-Weiss model). We’ll see this in action in the next section…\nGoing back to our problem, let’s analyze the entires of \\(Q\\) assuming replica symmetry. We already know the diagonal \\(Q_{aa} = 1\\), what about the off-diagonal. Well recall entries can only take in two values \\(Q_{ab} \\in \\{0, 1\\}\\):\n\nFor \\(Q_{ab} = 0\\), we’ll denote these solutions as \\(Q_{RS,0}\\). Then \\[\\begin{align}\n\\mathcal N_N(Q_{RS,0}) & = \\prod_{\\alpha=0}^{n-1} (2^N - \\alpha) \\\\\ns(Q_{RS,0}) & = \\frac{1}{N} \\sum_{\\alpha =0}^{n-1} \\log(2^N - \\alpha) \\approx \\frac{1}{N} \\sum_{\\alpha = 0}^{n-1} \\log(2^N) = n \\log 2\\\\\ng_0(\\beta, n) \\equiv g(Q_{RS,0}) & = n (\\frac{\\beta^2}{4} + \\log 2)\n\\end{align}\\]\nFor \\(Q_{ab} = 1\\), we’ll denote these solutions as \\(Q_{RS,1}\\). Then \\[\\begin{align}\n\\mathcal N_N(Q_{RS,1}) & = 2^N\\\\\ns(Q_{RS,1}) & = \\log 2\\\\\ng_1(\\beta, n) \\equiv g(Q_{RS,1}) & = \\frac{n^2 \\beta^2}{4} + \\log 2\n\\end{align}\\]\n\nBecause we’re approximating this as a saddle point, our solution will be dictated by becomes \\(\\text{max}[g_0(\\beta, n), g_1(\\beta, n)]\\). Interpretation-wise, we can say there’s a phase-transition between the \\(g_0\\) solution and the \\(g_1\\) solution, which is \\(\\beta_c(n) = \\sqrt{4 \\log 2 /n}\\)\n\nWhen \\(n &gt; 1\\):\n\nIf \\(\\beta &gt; \\beta_c\\) (low temperature phase), then \\(g_1 &gt; g_0\\). The \\(g_1\\) solution dominates, all replicas are locked together.\nIf \\(\\beta &lt; \\beta_c\\) (high temperature phase), then \\(g_0 &lt; g_1\\). The \\(g_0\\) solution dominates, hence all replicas are independent.\n\nWhen \\(n &lt; 1\\), which is the limit we’ll eventually take, the phases flip (in temperature!)\n\nIf \\(\\beta &gt; \\beta_c\\) (low temperature phase), then \\(g_1 &lt; g_0\\).\nIf \\(\\beta &lt; \\beta_c\\) (high temperature phase), then \\(g_0 &gt; g_1\\).\nReplicas becomes independent at low temperatures, and correlated at high temperatures. Wait whaaaat? We’ve previously stated that they are correlated…\n\n\nIn the \\(n&lt; 1\\) regime, replica trick requires us to use the minimum of \\(g(Q)\\)… There is no mathematical justification for this.\nLet’s compute the free energy now \\[\\begin{align}\n    - \\beta f & \\equiv \\lim_{N \\to \\infty} \\frac{1}{N} \\mathbb E [\\log Z] \\\\\n    & = \\lim_{N \\to \\infty} \\lim_{n \\to 0} \\frac{1}{N n} \\log (\\mathbb E[Z^n]) & \\text{Replica trick formula}\\\\\n    & = \\lim_{n \\to 0} \\lim_{N \\to \\infty} \\frac{1}{N n} \\log (\\mathbb E[Z^n])  & \\text{Interchange limits (non rigorous)}\\\\\n    & = \\lim_{n \\to 0} \\frac{g_0(n, \\beta)}{n} = \\frac{\\beta^2}{4} + \\log 2\n\\end{align}\\] We have recovered the low temperature phase \\(\\beta &gt; \\beta_c\\), but it misses the existence of the phase transition. In general, the RS solution isn’t able to find the low temperature phase."
  },
  {
    "objectID": "blog/replica-trick-tutorial.html#one-step-replica-symmetry-breaking-1rsb-solution",
    "href": "blog/replica-trick-tutorial.html#one-step-replica-symmetry-breaking-1rsb-solution",
    "title": "Tutorial on Replica Trick",
    "section": "One-Step Replica-Symmetry Breaking (1RSB) Solution",
    "text": "One-Step Replica-Symmetry Breaking (1RSB) Solution\nTo recover the lower temperature phase, perhaps the system breaks replica symmetry! So how do we find these new saddle points? We’ll use one-step replica symmetry break.\nThe idea is to suppose \\(n\\) is a multiple of \\(x\\), divide the \\(n\\) replicas into \\(n/x\\) groups of \\(x\\) elements, and now set \\[\\begin{align*}\n    Q_{aa} &= \\alpha_1  &\\text{In this problem it is 1}\\\\\n    Q_{ab} & = \\beta_1 & \\text{If $a$ and $b$ are in the same group}\\\\\n    Q_{ab} & = \\gamma_1 & \\text{If $a$ and $b$ are NOT in the same group}\n\\end{align*}\\] Recall for for this problem, it’s a symmetric matrix with elements in \\(\\{0,1\\}\\). So \\(Q_{aa}  = 1\\), and this ansatz is only different if we allow \\(\\beta_1 = 1\\) and \\(\\gamma_1 = 0\\).\nSo now our indices becomes \\(i_1 = ... = i_x\\), \\(i_{x+1} = ... = i_{2x}\\). The number of microstates \\((i_1, ..., i_n)\\) which satsify this becomes \\[\\begin{align}\n    \\mathcal N_N(Q) &= 2^N \\times (2^N -  1) \\times ... \\times (2^N - n/x  +1 )\\\\\n    s(Q) &= (n/x) \\log 2\\\\\n    g_{1RSB}(\\beta, n, x) & = n (\\frac{\\beta^2}{4} x + \\frac{1}{x} \\log 2)\n\\end{align}\\] So now we’ll minimize this (recall our discussion / example earlier). Minimizing w.r.t. \\(x\\) yields \\[\\begin{align}\n    x_* = \\frac{2 \\sqrt{\\log 2}}{\\beta} = \\frac{\\beta_c}{\\beta}\n\\end{align}\\] We can now compute our free energy \\[\\begin{align}\n    - \\beta f & = \\lim_{N \\to \\infty} \\frac{1}{N}\\mathbb E[\\log Z]\\\\\n    & = \\lim_{N \\to \\infty} \\lim_{n \\to 0} \\frac{1}{Nn} \\log(\\mathbb E[Z^n]) \\\\\n    & = \\lim_{n \\to 0}\\lim_{N \\to \\infty}\\frac{1}{Nn} \\log(\\mathbb E[Z^n])\\\\\n    & = \\lim_{n \\to 0} \\min_x \\frac{g_{1{RSB}}(\\beta, n \\, x)}{n} & \\text{Exchanged limits}\\\\\n    & = \\beta \\sqrt{\\log 2}\n\\end{align}\\] which is the correct result!"
  },
  {
    "objectID": "blog/replica-trick-tutorial.html#understanding-minimization-of-gcdot-via-toy-model",
    "href": "blog/replica-trick-tutorial.html#understanding-minimization-of-gcdot-via-toy-model",
    "title": "Tutorial on Replica Trick",
    "section": "Understanding minimization of \\(g(\\cdot)\\) via toy model",
    "text": "Understanding minimization of \\(g(\\cdot)\\) via toy model\nIn order to understand this oddity, we can examine a toy example. Consider the integral \\[\\begin{align}\n  Z(n) = \\int e^{-(N/2) \\sum_{(ab)} Q_{ab}^2} \\prod_{(ab)} dQ_{ab} = \\left (\\frac{2\\pi}{N} \\right)^{n(n-1)/4}\n\\end{align}\\] where \\((ab)\\) runs over all unordered pairs of indices \\(a,b \\in \\{1,...,n\\}\\) with \\(a\\neq b\\). For example: all unordered pairs of \\(\\{1,2,3,4\\}\\) is \\(\\{(1,2),(1,3),(1,4),(2,3),(2,4),(3,4)\\}\\); meaning it’s equivalent to \\(\\sum_{i &lt; j}\\).\nAnyways, in our case \\(g(Q) = - \\frac{1}{2} \\sum_{a&lt;b}Q^2_{ab}\\). If we assume the saddle point is dominated by the replica-symmetric point \\(Q^*_{ab} = q_0\\) for \\(a\\neq b\\). We get \\[\\begin{align}\n  g(Q^*) = - n(n-1)q_0^2 /4\n\\end{align}\\] To recover the \\(Z(n=0) = 1\\) limit, we should make \\(q_0 = 0\\). However, \\(q_0 = 0\\) corresponds to when \\(g(Q^*, q_0 = 0)\\) is minimized. Hmm…\nMezard & Montanari explain this by saying that the number of degrees of freedom become negative when \\(n &lt; 1\\). But it isn’t clear to me if this reason generalizes, and what the implications are."
  },
  {
    "objectID": "blog/replica-trick-tutorial.html#saddle-point",
    "href": "blog/replica-trick-tutorial.html#saddle-point",
    "title": "Tutorial on Replica Trick",
    "section": "Saddle Point",
    "text": "Saddle Point\nThe saddle point approximation is for estimating integrals of the form \\[\\begin{align}\n    I = \\int e^{-f(x)} dx\n\\end{align}\\] The idea is that the exponential will pick out the minimum of \\(f(x)\\) and exponentially kill other contributions. We can get an analytic result if we Taylor expand \\(f(x)\\) to second order around it’s minimum \\(x_0\\) \\[\\begin{align}\n    f(x) \\approx  f(x_0) + \\cancel{f'(x_0)} x_0 + \\frac{1}{2} f''(x_0) (x - x_0)^2 + \\mathcal O(x^3)\n\\end{align}\\] Plugging this into the integral, we get a gaussian \\[\\begin{align}\n    I \\approx e^{-f(x_0)} \\int e^{-\\frac{f''(x_0)}{2}(x-x_0)^2} dx = e^{-f(x_0)} \\sqrt{\\frac{2\\pi}{f''(x_0)}}\n\\end{align}\\]"
  },
  {
    "objectID": "blog/replica-trick-tutorial.html#gartner-ellis-theorem",
    "href": "blog/replica-trick-tutorial.html#gartner-ellis-theorem",
    "title": "Tutorial on Replica Trick",
    "section": "Gartner-Ellis Theorem",
    "text": "Gartner-Ellis Theorem\nDefinition (Exposed Point): \\(x \\in \\mathbb R\\) is consider an exposed point for function \\(f: \\mathbb R \\to \\mathbb R\\), if \\(\\exists t\\) s.t. \\(\\forall y \\neq x\\) the following holds \\[\\begin{align}\n  t y - f(y) &gt; t x - f(x)\n\\end{align}\\]"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "<a href='/index.qmd'>Clark Miyamoto</a>",
    "section": "",
    "text": "Clark Miyamoto is a Physics PhD student at NYU. I’m interestd in the intersection between statistical physics / inference problems / machine learning.\nAlso I failed English in high school, so send typo corrections to cm6627@nyu.edu."
  },
  {
    "objectID": "blog/index.html",
    "href": "blog/index.html",
    "title": "Blog posts",
    "section": "",
    "text": "Tutorial on Replica Trick\n\n\n\n\n\n\n\n\n\n\n\nFeb 2025\n\n\nClark Miyamoto\n\n\n\n\n\n\nNo matching items"
  }
]